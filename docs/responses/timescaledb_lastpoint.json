{
  "query": "SELECT DISTINCT ON (t.hostname) * FROM tags t INNER JOIN LATERAL(SELECT * FROM cpu c WHERE c.tags_id = t.id ORDER BY time DESC LIMIT 1) AS b ON true ORDER BY t.hostname, b.time DESC",
  "results": [
    {
      "additional_tags": null,
      "arch": "x86",
      "datacenter": "eu-central-1a",
      "hostname": "host_0",
      "id": 1,
      "os": "Ubuntu15.10",
      "rack": "6",
      "region": "eu-central-1",
      "service": "19",
      "service_environment": "test",
      "service_version": "1",
      "tags_id": 1,
      "team": "SF",
      "time": "2016-01-01T23:59:50Z",
      "usage_guest": 17,
      "usage_guest_nice": 84,
      "usage_idle": 22,
      "usage_iowait": 5,
      "usage_irq": 76,
      "usage_nice": 8,
      "usage_softirq": 94,
      "usage_steal": 52,
      "usage_system": 34,
      "usage_user": 69
    },
    {
      "additional_tags": null,
      "arch": "x64",
      "datacenter": "us-west-1a",
      "hostname": "host_1",
      "id": 2,
      "os": "Ubuntu15.10",
      "rack": "41",
      "region": "us-west-1",
      "service": "9",
      "service_environment": "staging",
      "service_version": "1",
      "tags_id": 2,
      "team": "NYC",
      "time": "2016-01-01T23:59:50Z",
      "usage_guest": 67,
      "usage_guest_nice": 8,
      "usage_idle": 58,
      "usage_iowait": 87,
      "usage_irq": 13,
      "usage_nice": 81,
      "usage_softirq": 92,
      "usage_steal": 53,
      "usage_system": 48,
      "usage_user": 76
    },
    {
      "additional_tags": null,
      "arch": "x86",
      "datacenter": "sa-east-1a",
      "hostname": "host_2",
      "id": 3,
      "os": "Ubuntu16.04LTS",
      "rack": "89",
      "region": "sa-east-1",
      "service": "13",
      "service_environment": "staging",
      "service_version": "0",
      "tags_id": 3,
      "team": "LON",
      "time": "2016-01-01T23:59:50Z",
      "usage_guest": 69,
      "usage_guest_nice": 22,
      "usage_idle": 24,
      "usage_iowait": 90,
      "usage_irq": 24,
      "usage_nice": 67,
      "usage_softirq": 35,
      "usage_steal": 45,
      "usage_system": 46,
      "usage_user": 5
    },
    {
      "additional_tags": null,
      "arch": "x64",
      "datacenter": "us-west-2b",
      "hostname": "host_3",
      "id": 4,
      "os": "Ubuntu15.10",
      "rack": "12",
      "region": "us-west-2",
      "service": "18",
      "service_environment": "production",
      "service_version": "1",
      "tags_id": 4,
      "team": "CHI",
      "time": "2016-01-01T23:59:50Z",
      "usage_guest": 23,
      "usage_guest_nice": 39,
      "usage_idle": 58,
      "usage_iowait": 11,
      "usage_irq": 34,
      "usage_nice": 80,
      "usage_softirq": 41,
      "usage_steal": 97,
      "usage_system": 59,
      "usage_user": 17
    },
    {
      "additional_tags": null,
      "arch": "x86",
      "datacenter": "sa-east-1c",
      "hostname": "host_4",
      "id": 5,
      "os": "Ubuntu16.10",
      "rack": "74",
      "region": "sa-east-1",
      "service": "7",
      "service_environment": "staging",
      "service_version": "0",
      "tags_id": 5,
      "team": "SF",
      "time": "2016-01-01T23:59:50Z",
      "usage_guest": 88,
      "usage_guest_nice": 37,
      "usage_idle": 70,
      "usage_iowait": 52,
      "usage_irq": 85,
      "usage_nice": 53,
      "usage_softirq": 15,
      "usage_steal": 10,
      "usage_system": 37,
      "usage_user": 2
    },
    {
      "additional_tags": null,
      "arch": "x64",
      "datacenter": "us-west-1b",
      "hostname": "host_5",
      "id": 6,
      "os": "Ubuntu16.10",
      "rack": "18",
      "region": "us-west-1",
      "service": "14",
      "service_environment": "staging",
      "service_version": "0",
      "tags_id": 6,
      "team": "CHI",
      "time": "2016-01-01T23:59:50Z",
      "usage_guest": 70,
      "usage_guest_nice": 27,
      "usage_idle": 30,
      "usage_iowait": 9,
      "usage_irq": 34,
      "usage_nice": 64,
      "usage_softirq": 47,
      "usage_steal": 0,
      "usage_system": 51,
      "usage_user": 7
    },
    {
      "additional_tags": null,
      "arch": "x86",
      "datacenter": "ap-southeast-1b",
      "hostname": "host_6",
      "id": 7,
      "os": "Ubuntu16.10",
      "rack": "49",
      "region": "ap-southeast-1",
      "service": "7",
      "service_environment": "staging",
      "service_version": "0",
      "tags_id": 7,
      "team": "CHI",
      "time": "2016-01-01T23:59:50Z",
      "usage_guest": 17,
      "usage_guest_nice": 97,
      "usage_idle": 43,
      "usage_iowait": 60,
      "usage_irq": 42,
      "usage_nice": 65,
      "usage_softirq": 49,
      "usage_steal": 63,
      "usage_system": 81,
      "usage_user": 48
    },
    {
      "additional_tags": null,
      "arch": "x64",
      "datacenter": "eu-west-1c",
      "hostname": "host_7",
      "id": 8,
      "os": "Ubuntu16.10",
      "rack": "44",
      "region": "eu-west-1",
      "service": "7",
      "service_environment": "test",
      "service_version": "1",
      "tags_id": 8,
      "team": "LON",
      "time": "2016-01-01T23:59:50Z",
      "usage_guest": 19,
      "usage_guest_nice": 67,
      "usage_idle": 57,
      "usage_iowait": 11,
      "usage_irq": 32,
      "usage_nice": 6,
      "usage_softirq": 70,
      "usage_steal": 0,
      "usage_system": 61,
      "usage_user": 52
    },
    {
      "additional_tags": null,
      "arch": "x64",
      "datacenter": "eu-west-1a",
      "hostname": "host_8",
      "id": 9,
      "os": "Ubuntu16.04LTS",
      "rack": "17",
      "region": "eu-west-1",
      "service": "2",
      "service_environment": "test",
      "service_version": "0",
      "tags_id": 9,
      "team": "LON",
      "time": "2016-01-01T23:59:50Z",
      "usage_guest": 49,
      "usage_guest_nice": 38,
      "usage_idle": 44,
      "usage_iowait": 78,
      "usage_irq": 55,
      "usage_nice": 33,
      "usage_softirq": 31,
      "usage_steal": 72,
      "usage_system": 81,
      "usage_user": 79
    },
    {
      "additional_tags": null,
      "arch": "x86",
      "datacenter": "ap-southeast-2a",
      "hostname": "host_9",
      "id": 10,
      "os": "Ubuntu16.04LTS",
      "rack": "0",
      "region": "ap-southeast-2",
      "service": "18",
      "service_environment": "production",
      "service_version": "0",
      "tags_id": 10,
      "team": "CHI",
      "time": "2016-01-01T23:59:50Z",
      "usage_guest": 52,
      "usage_guest_nice": 22,
      "usage_idle": 46,
      "usage_iowait": 38,
      "usage_irq": 19,
      "usage_nice": 28,
      "usage_softirq": 6,
      "usage_steal": 81,
      "usage_system": 81,
      "usage_user": 74
    }
  ]
}

Run complete after 1 queries with 1 workers (Overall query rate 72.63 queries/sec):
TimescaleDB last row per host:
min:    13.48ms, med:    13.48ms, mean:    13.48ms, max:   13.48ms, stddev:     0.00ms, sum:   0.0sec, count: 1
all queries                  :
min:    13.48ms, med:    13.48ms, mean:    13.48ms, max:   13.48ms, stddev:     0.00ms, sum:   0.0sec, count: 1
wall clock time: 0.018298sec
